"""
Состояния для Finite State Machine (FSM) пользователей.

FSM позволяет отслеживать, в каком состоянии находится пользователь
во время взаимодействия с ботом. Это необходимо для реализации
многошаговых сценариев, таких как прохождение маршрута.

Основные группы состояний:
- RouteStates: Состояния при работе с маршрутами
- DeliveryStates: Состояния при формировании доставок
"""

from aiogram.fsm.state import State, StatesGroup


class RouteStates(StatesGroup):
    """
    Группа состояний для работы с маршрутами.
    
    Эти состояния используются при прохождении курьером маршрута:
    от выбора города до завершения сбора товаров.
    """
    
    # Ожидание выбора города для маршрута
    waiting_for_city_selection = State()
    
    # Ожидание подтверждения выбранного маршрута
    waiting_for_route_confirmation = State()
    
    # Маршрут активен, ожидаем фотографию с текущей точки
    waiting_for_photo = State()
    
    # Первая фотография получена, ожидаем решение - добавить еще или продолжить
    waiting_for_photo_decision = State()
    
    # Ожидаем дополнительные фотографии
    waiting_for_additional_photos = State()
    
    # Фотографии готовы, ожидаем количество контейнеров
    waiting_for_containers_count = State()
    
    # Контейнеры указаны, ожидаем комментарий к точке
    waiting_for_comment = State()
    
    # Новое состояние: управление всеми действиями на точке (фото, контейнеры, комментарий)
    managing_point_data = State()
    
    # Ожидание подтверждения перехода к следующей точке
    waiting_for_next_point_confirmation = State()
    
    # Все точки маршрута пройдены, ожидаем завершения
    waiting_for_route_completion = State()


class DeliveryStates(StatesGroup):
    """
    Группа состояний для работы с доставками в Москву.
    
    Используется администраторами для формирования и управления
    маршрутными листами доставки в Москву.
    """
    
    # Ожидание выбора даты для формирования доставки
    waiting_for_delivery_date = State()
    
    # Ожидание выбора организации для доставки
    waiting_for_organization_selection = State()
    
    # Ожидание подтверждения создания маршрутного листа
    waiting_for_delivery_confirmation = State()
    
    # Ожидание назначения курьера для доставки в Москву
    waiting_for_courier_assignment = State()


class AdminStates(StatesGroup):
    """
    Группа состояний для административных функций.
    
    Используется администраторами для управления системой:
    добавление маршрутов, управление пользователями и т.д.
    """
    
    # Ожидание данных для добавления нового маршрута
    waiting_for_route_data = State()
    
    # Ожидание подтверждения административного действия
    waiting_for_admin_confirmation = State()
    
    # Ожидание ID пользователя для административных действий
    waiting_for_user_id = State()


# Дополнительные служебные состояния
class GeneralStates(StatesGroup):
    """
    Общие состояния для различных служебных операций.
    """
    
    # Ожидание текстового ввода от пользователя
    waiting_for_text_input = State()
    
    # Ожидание подтверждения любого действия
    waiting_for_confirmation = State()
    
    # Обработка ошибки, ожидание повторной попытки
    waiting_for_retry = State()
